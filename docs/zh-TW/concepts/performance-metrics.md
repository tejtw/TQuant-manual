# 績效指標詳解：Pyfolio 全方位分析

!!! info
    本頁面說明 TQuant Lab 生成之 Pyfolio 全版報表 (Full Tear Sheet) 中的各項關鍵指標定義與判讀方式。
    
    > **注意**：本文檔中出現的數值與圖表僅為 **範例數據 (Sample Data)**，旨在演示如何解讀報表，並非特定策略的保證績效。

---

## 1. 核心績效概覽 (Performance Statistics)

此區塊位於報表最上方，提供策略的整體獲利能力與風險調整後表現的統計摘要。

### 1.1. 報酬與波動類

#### Annual return (年化報酬率)
* **定義**：將策略的總報酬換算為每年的平均複利增長率。
* **判讀**：衡量策略獲利能力最直觀的指標。

#### Annual volatility (年化波動率)
* **定義**：衡量資產收益率的標準差，反映價格變動的劇烈程度。
* **判讀**：數值越高，代表資產價格波動越大，風險越高。台股大盤長期平均波動率約在 15%~20% 之間。

!!! example "範例解讀"
    * **Annual return**: `37.43%` —— 代表此範例策略每年平均增長 37%。
    * **Annual volatility**: `24.67%` —— 代表波動程度高於一般大盤，屬於積極型策略。

### 1.2. 風險調整收益類

#### Sharpe ratio (夏普比率)
* **定義**：衡量每承擔一單位總風險 (波動率)，能換取多少超額報酬。
* **公式**：$(R_p - R_f) / \sigma_p$
* **判讀**：
    * `> 1.0`：策略表現良好，報酬足以彌補風險。
    * `> 2.0`：策略表現優秀。
    * `< 0`：策略表現不如無風險資產（如定存）。

#### Sortino ratio (索提諾比率)
* **定義**：夏普比率的改良版。計算時只考慮 **下檔波動 (Downside Volatility)**，即只將「虧損的波動」視為風險，忽略上漲帶來的波動。
* **判讀**：若 Sortino 比 Sharpe 高，代表策略的波動主要來自於價格上漲（這是好的波動）。

!!! example "範例解讀"
    在此範例中，**Sharpe** 為 `1.41`，而 **Sortino** 高達 `2.11`。這顯示策略雖然波動率高 (24%)，但大部分波動是向上獲利的，下檔風險相對可控。

---

## 2. 進階風險指標 (Risk Metrics)

此區塊揭露了極端情況下的風險特徵，對於風險控管至關重要。

### Max drawdown (最大回撤)
* **定義**：在選定期間內，資產從歷史最高點跌落至最低點的最大跌幅。
* **判讀**：代表投資人可能面臨的最壞帳面虧損。

### Omega ratio (歐米伽比率)
* **定義**：獲利幅度與虧損幅度的機率加權比率。
* **判讀**：衡量「獲利潛力」相對於「虧損潛力」的盈虧比。數值大於 1 代表獲利期望值大於虧損。

### Skew (偏度) 與 Kurtosis (峰度)
* **Skew (偏度)**：衡量報酬分佈的對稱性。
    * **負值 (左偏)**：代表策略容易出現極端的小機率虧損（黑天鵝事件）。
* **Kurtosis (峰度)**：衡量分佈的「肥尾」程度。
    * **高數值**：代表極端行情發生的頻率高於常態分佈的預期。

!!! example "範例解讀"
    * **Max drawdown**: `-34.80%` —— 歷史最大跌幅曾達三分之一，使用者需評估資金承受力。
    * **Kurtosis**: `5.78` —— 數值偏高，暗示策略具有肥尾效應，需提防突發性的極端行情。

---

## 3. 持倉與交易特徵 (Holdings & Trading)

此部分反映策略的運作風格、交易成本與潛在的結構性風險。

### Daily turnover (每日換手率)
* **定義**：每日買賣金額佔總資產的比例。
* **判讀**：
    * 數值越高，代表交易越頻繁，手續費與滑價成本越高。
    * 平均持倉週期約為 $1 / Turnover$。

### Top 10 Positions (十大持倉佔比)
* **定義**：前十大持股佔總資產的百分比。
* **判讀**：用於評估 **集中度風險 (Concentration Risk)**。若單一個股佔比過高，策略績效將過度依賴單一標的。

!!! example "範例解讀：高度集中的風險"
    下表為某策略的持倉範例。可見前兩大持股佔比皆超過 **42%**：
    
    | Stock | Max % |
    | :--- | :--- |
    | 2615 | **42.38%** |
    | 2915 | **42.14%** |
    
    這顯示該範例策略具有極高的集中度風險，單一個股的漲跌對淨值影響巨大。

---

## 4. 關鍵圖表說明 (Key Charts)

### 4.1. 最差回撤期 (Worst Drawdown Periods)

此表格列出了歷史上跌幅最深的幾次事件，幫助使用者了解策略在逆境中的表現。

* **Net drawdown**：跌幅百分比。
* **Peak / Valley**：起跌點與最低點日期。
* **Duration**：從起跌到完全解套（淨值創新高）所經歷的時間。

!!! example "範例數據"
    | Rank | Net Drawdown | Duration | 說明 |
    | :--- | :--- | :--- | :--- |
    | 1 | -34.80% | 471 Days | 範例策略曾經歷長達 1 年以上的資金套牢期。 |
    | 2 | -31.02% | 105 Days | 次大跌幅發生在短時間內，但恢復速度較快。 |

### 4.2. 水下圖 (Underwater Plot)

* **定義**：將歷史高點設為 0%，視覺化呈現淨值回落的幅度與時間長度。
* **用途**：快速識別策略的「痛苦期」。若陰影面積大且深，代表策略長期處於虧損或回補狀態。

---

## 5. 因子分析 (Factor Analysis)

評估策略報酬來源是來自於選股能力 (Alpha) 還是市場趨勢 (Beta)。

* **Alpha (阿爾法)**：扣除市場風險後的超額報酬。正值代表策略具有擊敗大盤的能力。
* **Beta (貝塔)**：策略對大盤波動的敏感度。
    * $\beta = 1$：與大盤同步。
    * $\beta = 0$：與大盤無關（市場中性）。

!!! example "範例解讀"
    * **Alpha**: `0.20` —— 策略具備選股能力，能創造年化 20% 的超額報酬。
    * **Beta**: `0.88` —— 策略與大盤高度正相關，屬於順勢型策略。

---

## 6. 常見回測陷阱 (Pitfalls)

!!! failure "前視偏差 (Look-ahead Bias)"
    在回測中使用了「未來才知道」的資訊。例如：在計算今日訊號時，不小心用到了「今日收盤價」（現實中盤中無法預知收盤價）。這是導致回測失真的頭號殺手。

!!! failure "生存偏差 (Survivorship Bias)"
    只選了「現在還活著」的股票回測。例如回測 2000 年科技股時，忽略了那些已經倒閉下市的公司，導致績效被嚴重高估。

!!! warning "過度擬合 (Overfitting)"
    在歷史數據上表現完美（例如年化 200%），但在真實交易中一塌糊塗。通常是因為參數過多，刻意迎合了歷史雜訊。