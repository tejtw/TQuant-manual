/* --- UI Optimization: Premium Quality Enhancements for Material for MkDocs --- */
/* Direct fixes for all 5 issues: search, header bar, Mermaid, code blocks, admonitions */

/* === GLOBAL CSS VARIABLES FOR THEME AWARENESS === */

:root {
  /* Shadow colors - refined for depth */
  --md-shadow-color-light: rgba(0, 0, 0, 0.2);
  --md-shadow-color-dark: rgba(0, 0, 0, 0.25);

  /* Mermaid colors for light theme - Premium quality */
  --mermaid-node-fill-light: #f0f4ff;
  --mermaid-node-stroke-light: #3f51b5;
  --mermaid-text-fill-light: #1a1a1a;
  --mermaid-edge-stroke-light: #3f51b5;
  --mermaid-cluster-fill-light: #e8eef7;
  --mermaid-cluster-stroke-light: #3f51b5;

  /* Heading accent colors */
  --heading-h1-color: #1a73e8;
  --heading-h2-color: #1e88e5;
  --heading-h3-color: #1976d2;
}

@media (prefers-color-scheme: dark) {
  :root {
    --md-shadow-color-light: rgba(255, 255, 255, 0.15);
    --md-shadow-color-dark: rgba(255, 255, 255, 0.25);

    /* Mermaid colors for dark theme - Premium quality */
    --mermaid-node-fill-dark: #2d3748;
    --mermaid-node-stroke-dark: #64b5f6;
    --mermaid-text-fill-dark: #f5f5f5;
    --mermaid-edge-stroke-dark: #64b5f6;
    --mermaid-cluster-fill-dark: #1f2937;
    --mermaid-cluster-stroke-dark: #64b5f6;

    /* Heading colors for dark mode */
    --heading-h1-color: #90caf9;
    --heading-h2-color: #81d4fa;
    --heading-h3-color: #80deea;
  }
}

/* === GENERAL TYPOGRAPHY === */

.md-typeset {
  font-size: 1.25em;
  line-height: 1.8;
  letter-spacing: 0.3px;
  color: var(--md-default-fg-color);
}

.md-typeset p {
  font-size: 1.2em;
  margin-bottom: 1.2em;
  color: var(--md-default-fg-color);
}

/* === PROBLEM 1 FIX: SEARCH BOX - VISIBLE IN BOTH THEMES === */

.md-search__form {
  border-radius: 8px;
  box-shadow: 0 2px 4px var(--md-shadow-color-light);
  transition: all 0.3s ease-in-out;
  background-color: var(--md-default-bg-color);
}

.md-search__form:focus-within {
  box-shadow: 0 4px 12px var(--md-shadow-color-light);
}

/* Critical: Search input text must be visible in both modes */
.md-search__input {
  color: rgba(0, 0, 0, 0.87) !important;
  background-color: #ffffff !important;
  border: 1px solid #e0e0e0 !important;
  border-radius: 4px;
  font-size: 1.1em;
  padding: 0.8em 0.8em 0.8em 2.5em !important;
  line-height: 1.6;
  vertical-align: middle;
}

.md-search__input::placeholder {
  color: rgba(0, 0, 0, 0.54) !important;
  opacity: 1;
}

.md-search__form {
  position: relative;
}

.md-search__icon {
  width: 1.3em !important;
  height: 1.3em !important;
  position: absolute;
  left: 0.8em;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}

@media (prefers-color-scheme: dark) {
  .md-search__input {
    color: #ffffff !important;
    background-color: #2c2c2c !important;
    border: 1px solid #424242 !important;
  }
  .md-search__input::placeholder {
    color: rgba(255, 255, 255, 0.8) !important;
    opacity: 1;
  }
  
  .md-typeset {
    color: #e8e8e8 !important;
  }
  
  .md-typeset p {
    color: #e8e8e8 !important;
  }
}

@media (prefers-color-scheme: light) {
  .md-typeset {
    color: #2c2c2c !important;
  }
  
  .md-typeset p {
    color: #2c2c2c !important;
  }
}

/* === PROBLEM 2 FIX: HEADER BAR OPTIMIZATION === */

.md-header {
  box-shadow: 0 2px 4px var(--md-shadow-color-light);
  transition: box-shadow 0.3s ease-in-out;
}

.md-header:hover {
  box-shadow: 0 4px 8px var(--md-shadow-color-light);
}

.md-header__topic {
  font-weight: 600 !important;
  font-size: 1.05em !important;
  letter-spacing: 0.5px;
}

.md-header__topic.md-text--ellipsis {
  color: var(--md-default-fg-color) !important;
}

/* === PROBLEM 5 FIX: HEADING COLORS FOR VISUAL ACCENT === */

h1, .md-typeset h1 {
  color: var(--heading-h1-color) !important;
  font-weight: 700 !important;
  margin-top: 1.5em;
  margin-bottom: 0.5em;
  border-bottom: 3px solid var(--heading-h1-color);
  padding-bottom: 0.3em;
}

h2, .md-typeset h2 {
  color: var(--heading-h2-color) !important;
  font-weight: 700 !important;
  margin-top: 1.2em;
  margin-bottom: 0.4em;
  border-bottom: 2px solid var(--heading-h2-color);
  padding-bottom: 0.2em;
}

h3, .md-typeset h3 {
  color: var(--heading-h3-color) !important;
  font-weight: 600 !important;
  margin-top: 1em;
  margin-bottom: 0.3em;
}

h4, .md-typeset h4 {
  font-weight: 600;
  margin-top: 0.8em;
  margin-bottom: 0.2em;
}

/* === PROBLEM 4 FIX: CODE BLOCK QUALITY ELEVATION === */

.md-typeset pre {
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.04));
  border-left: 4px solid var(--md-accent-fg-color);
  border-radius: 8px;
  padding: 1.2em;
  margin: 1.2em 0;
  box-shadow: 0 2px 8px var(--md-shadow-color-light),
              inset 0 1px 0 rgba(255, 255, 255, 0.3);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow-x: auto;
  overflow-y: auto;
}

.md-typeset pre:hover {
  box-shadow: 0 8px 24px var(--md-shadow-color-light),
              inset 0 1px 0 rgba(255, 255, 255, 0.3);
  transform: translateY(-2px);
}

@media (prefers-color-scheme: dark) {
  .md-typeset pre {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.03), rgba(255, 255, 255, 0.05));
    box-shadow: 0 2px 8px var(--md-shadow-color-light),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }
  .md-typeset pre:hover {
    box-shadow: 0 8px 24px var(--md-shadow-color-light),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
  }
}

.md-typeset code {
  font-size: 0.9em;
  background-color: rgba(0, 0, 0, 0.05);
  color: #e53935;
  padding: 0.2em 0.4em;
  border-radius: 3px;
  font-weight: 500;
}

@media (prefers-color-scheme: dark) {
  .md-typeset code {
    background-color: rgba(255, 255, 255, 0.1);
    color: #ff9800;
  }
}

/* === PROBLEM 5 FIX: ADMONITION BLOCKS QUALITY ELEVATION === */

.md-typeset .admonition {
  border-left: 5px solid;
  padding: 1.2em 1.5em;
  margin: 1.5em 0;
  border-radius: 8px;
  box-shadow: 0 2px 8px var(--md-shadow-color-light);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  background: linear-gradient(135deg, rgba(0, 0, 0, 0.02), rgba(0, 0, 0, 0.04));
  backdrop-filter: blur(10px);
}

.md-typeset .admonition:hover {
  box-shadow: 0 6px 16px var(--md-shadow-color-light);
  transform: translateY(-2px);
}

/* Info block styling */
.md-typeset .admonition.info {
  border-color: #1976d2;
  background: linear-gradient(135deg, rgba(25, 118, 210, 0.05), rgba(25, 118, 210, 0.02)) !important;
}

.md-typeset .admonition.info > .admonition-title {
  color: #1565c0 !important;
  font-weight: 700 !important;
}

/* Warning block styling */
.md-typeset .admonition.warning {
  border-color: #f57c00;
  background: linear-gradient(135deg, rgba(245, 124, 0, 0.05), rgba(245, 124, 0, 0.02)) !important;
}

.md-typeset .admonition.warning > .admonition-title {
  color: #e65100 !important;
  font-weight: 700 !important;
}

/* Important/Danger block styling */
.md-typeset .admonition.important {
  border-color: #d32f2f;
  background: linear-gradient(135deg, rgba(211, 47, 47, 0.05), rgba(211, 47, 47, 0.02)) !important;
}

.md-typeset .admonition.important > .admonition-title {
  color: #b71c1c !important;
  font-weight: 700 !important;
}

/* Dark mode admonition adjustments */
@media (prefers-color-scheme: dark) {
  .md-typeset .admonition {
    background: linear-gradient(135deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.02)) !important;
    box-shadow: 0 2px 8px var(--md-shadow-color-light);
  }

  .md-typeset .admonition:hover {
    box-shadow: 0 6px 16px var(--md-shadow-color-light);
  }

  .md-typeset .admonition.info {
    background: linear-gradient(135deg, rgba(100, 181, 246, 0.1), rgba(100, 181, 246, 0.05)) !important;
  }

  .md-typeset .admonition.info > .admonition-title {
    color: #90caf9 !important;
  }

  .md-typeset .admonition.warning {
    background: linear-gradient(135deg, rgba(255, 152, 0, 0.1), rgba(255, 152, 0, 0.05)) !important;
  }

  .md-typeset .admonition.warning > .admonition-title {
    color: #ffb74d !important;
  }

  .md-typeset .admonition.important {
    background: linear-gradient(135deg, rgba(239, 154, 154, 0.1), rgba(239, 154, 154, 0.05)) !important;
  }

  .md-typeset .admonition.important > .admonition-title {
    color: #ef9a9a !important;
  }
}

/* === TABLE STYLING === */

.md-typeset table {
  width: 100%;
  border-collapse: collapse;
  margin: 1.5em 0;
  border-radius: 8px;
  box-shadow: 0 2px 8px var(--md-shadow-color-light);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  overflow: hidden;
}

.md-typeset table:hover {
  box-shadow: 0 6px 16px var(--md-shadow-color-light);
  transform: translateY(-2px);
}

.md-typeset th, .md-typeset td {
  border: 1px solid var(--md-default-fg-color--lightest);
  padding: 0.9em 1em;
  text-align: left;
  font-size: 0.95em;
}

.md-typeset th {
  background: linear-gradient(135deg, var(--md-primary-fg-color), var(--md-accent-fg-color));
  color: white;
  font-weight: 700;
  letter-spacing: 0.5px;
}

.md-typeset tbody tr:nth-child(even) {
  background-color: rgba(0, 0, 0, 0.02);
}

@media (prefers-color-scheme: dark) {
  .md-typeset tbody tr:nth-child(even) {
    background-color: rgba(255, 255, 255, 0.03);
  }
}

/* === LINKS STYLING === */

.md-typeset a {
  color: var(--md-accent-fg-color);
  text-decoration: none;
  transition: all 0.3s ease-in-out;
  position: relative;
  font-weight: 500;
}

.md-typeset a:hover {
  color: var(--md-primary-fg-color);
  text-decoration: underline;
  text-decoration-thickness: 2px;
  text-underline-offset: 3px;
}

/* === PROBLEM 3 FIX: MERMAID DIAGRAM QUALITY ELEVATION === */

.mermaid {
  background-color: transparent !important;
}

.mermaid svg {
  background-color: transparent !important;
  font-family: var(--md-text-font) !important;
  font-size: 1em !important;
}

/* Light mode - Premium Mermaid rendering */
.mermaid .node rect, 
.mermaid .node circle, 
.mermaid .node polygon {
  fill: var(--mermaid-node-fill-light) !important;
  stroke: var(--mermaid-node-stroke-light) !important;
  stroke-width: 2px !important;
  filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
}

.mermaid .node text {
  fill: var(--mermaid-text-fill-light) !important;
  font-weight: 600 !important;
  font-size: 1.1em !important;
}

.mermaid .edgePath .path {
  stroke: var(--mermaid-edge-stroke-light) !important;
  stroke-width: 2.5px !important;
  fill: none !important;
  filter: drop-shadow(0 1px 2px rgba(0, 0, 0, 0.08));
}

.mermaid .edgeLabel {
  background-color: rgba(255, 255, 255, 0.9) !important;
  border: 1px solid var(--mermaid-edge-stroke-light) !important;
  border-radius: 4px !important;
  padding: 0.3em 0.5em !important;
  font-size: 0.95em !important;
}

.mermaid .cluster rect {
  fill: var(--mermaid-cluster-fill-light) !important;
  stroke: var(--mermaid-cluster-stroke-light) !important;
  stroke-width: 2px !important;
  filter: drop-shadow(0 1px 3px rgba(0, 0, 0, 0.08));
}

.mermaid .cluster text {
  fill: var(--mermaid-node-stroke-light) !important;
  font-weight: 700 !important;
  font-size: 1.05em !important;
}

/* Dark mode - Premium Mermaid rendering */
@media (prefers-color-scheme: dark) {
  .mermaid .node rect, 
  .mermaid .node circle, 
  .mermaid .node polygon {
    fill: var(--mermaid-node-fill-dark) !important;
    stroke: var(--mermaid-node-stroke-dark) !important;
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.5));
  }

  .mermaid .node text {
    fill: var(--mermaid-text-fill-dark) !important;
    font-size: 1.1em !important;
  }

  .mermaid .edgePath .path {
    stroke: var(--mermaid-edge-stroke-dark) !important;
    filter: drop-shadow(0 1px 4px rgba(0, 0, 0, 0.5));
  }

  .mermaid .edgeLabel {
    background-color: rgba(45, 55, 72, 0.95) !important;
    border: 1px solid var(--mermaid-edge-stroke-dark) !important;
    color: var(--mermaid-text-fill-dark) !important;
  }

  .mermaid .cluster rect {
    fill: var(--mermaid-cluster-fill-dark) !important;
    stroke: var(--mermaid-cluster-stroke-dark) !important;
    filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.5));
  }

  .mermaid .cluster text {
    fill: var(--mermaid-node-stroke-dark) !important;
  }
}

/* === PROBLEM 4 FIX: COLLAPSIBLE SIDEBAR NAVIGATION === */

/* Keep sidebars visible - no aggressive hiding */
.md-sidebar {
  z-index: auto;
}

/* === PROBLEM 5 FIX: LIGHT MODE TEXT COLOR OPTIMIZATION === */

/* Reduce visual noise in light mode by softening contrast */
.md-typeset h1, 
.md-typeset h2, 
.md-typeset h3,
.md-typeset h4,
.md-typeset h5,
.md-typeset h6 {
  letter-spacing: 0.4px;
}

/* Soften accent colors in light mode for better readability */
@media (prefers-color-scheme: light) {
  .md-typeset {
    --md-default-fg-color: #333333;
  }
  
  .md-typeset a {
    color: #0066cc;
  }
  
  .md-typeset a:hover {
    color: #004499;
  }
  
  .md-typeset strong {
    color: #222222;
    font-weight: 700;
  }
  
  .md-typeset em {
    font-style: italic;
    color: #444444;
  }
}

/* === PROBLEM 6 FIX: MERMAID DIAGRAM TEXTURE & DEPTH === */

.mermaid {
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.15));
  border-radius: 12px;
  overflow: hidden;
  position: relative;
}

/* Enhanced node styling for texture */
.mermaid .node {
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.12));
  transition: filter 0.3s ease;
}

.mermaid .node:hover {
  filter: drop-shadow(0 4px 12px rgba(0, 0, 0, 0.2));
}

/* Enhanced path/edge styling */
.mermaid .edgePath {
  filter: drop-shadow(0 1px 3px rgba(0, 0, 0, 0.1));
  transition: filter 0.3s ease;
}

.mermaid .edgePath:hover {
  filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.15));
}

/* Cluster styling with better depth */
.mermaid .cluster {
  filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
}

/* Light mode: Enhanced Mermaid appearance */
@media (prefers-color-scheme: light) {
  .mermaid {
    background: #ffffff !important;
    padding: 2em;
    border-radius: 12px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    border: 1px solid #e8eef7;
  }
  
  .mermaid .node rect,
  .mermaid .node circle,
  .mermaid .node polygon {
    fill: #e8f0fe !important;
    stroke: #1e88e5 !important;
    stroke-width: 2.5px !important;
    filter: drop-shadow(0 1px 3px rgba(0, 0, 0, 0.1)) !important;
  }
  
  .mermaid .node text {
    fill: #0d47a1 !important;
    font-size: 1.1em !important;
    font-weight: 600 !important;
  }
  
  .mermaid .edgePath .path {
    stroke: #1565c0 !important;
    stroke-width: 2.5px !important;
  }
  
  .mermaid .edgeLabel {
    background-color: rgba(232, 240, 254, 0.98) !important;
    border: 2px solid #1e88e5 !important;
    color: #0d47a1 !important;
    font-weight: 500 !important;
  }
  
  .mermaid .cluster rect {
    fill: #f3f6fe !important;
    stroke: #1e88e5 !important;
    stroke-width: 2px !important;
    opacity: 0.9;
  }
  
  .mermaid .cluster text {
    fill: #0d47a1 !important;
    font-weight: 700 !important;
    font-size: 1.05em !important;
  }
}

/* Dark mode: Enhanced Mermaid appearance with better contrast */
@media (prefers-color-scheme: dark) {
  .mermaid {
    background: linear-gradient(135deg, #2a2a2a 0%, #1f1f1f 100%) !important;
    padding: 2em;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(255, 255, 255, 0.1);
  }
  
  .mermaid .node rect,
  .mermaid .node circle,
  .mermaid .node polygon {
    fill: #404854 !important;
    stroke: #90caf9 !important;
    stroke-width: 2.5px !important;
    filter: drop-shadow(0 2px 6px rgba(0, 0, 0, 0.4)) !important;
  }
  
  .mermaid .node text {
    fill: #ffffff !important;
    font-size: 1.1em !important;
    font-weight: 600 !important;
  }
  
  .mermaid .edgePath .path {
    stroke: #90caf9 !important;
    stroke-width: 2.5px !important;
  }
  
  .mermaid .edgeLabel {
    background-color: rgba(64, 72, 84, 0.98) !important;
    border: 1px solid #90caf9 !important;
    color: #ffffff !important;
  }
  
  .mermaid .cluster rect {
    fill: #3a4555 !important;
    stroke: #90caf9 !important;
    stroke-width: 2px !important;
  }
  
  .mermaid .cluster text {
    fill: #90caf9 !important;
    font-weight: 700 !important;
  }
}
